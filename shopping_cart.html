<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your shopping cart</title>
    <link crossorigin="anonymous" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" rel="stylesheet">
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <script>
        let cart_items = JSON.parse(localStorage.getItem('cartItems')); //produce an array of chair objects in the users cart
    </script>
</head>
<body>
<div class = "jumbotron jumbotron-fluid" style = "background-color: gray; margin-bottom: 0px">
    <div class = "container"><img alt = "chair-icon" src="images/home_page/iconchair.png" style = "height: 50px">
        <h1 class="display-4" style="color: white;"> Site Title </h1></div>

    <form><div class ="form-group" style="padding: 5px"><input aria-describedby="search" class="form-control" id="searchbar"
                                                               placeholder="Search Catalouge" type="email">
        <br><div class="container" id = "ourCart" style = "background-color: grey;"><button class="btn btn-outline-secondary" style="background-color: #3c3f41; padding: 15px; width: 100px; position: absolute; left: 70%" type = "button">
            <a href="shopping_cart.html" style = "color: white"><p id = "cart"> Cart </p></a></button><div></div>
        </div>
    </div></form></div>

    <script>
        // Display the shopping cart contents
        function displayCart() {
            for (let i = 0; i < cart_items.length; i++) {
                let div_tag = document.createElement('div');
                document.body.appendChild(div_tag);
                let main_table = document.createElement('table');
                main_table.setAttribute("border", "solid");
                div_tag.appendChild(main_table);
                let row = document.createElement('tr');
                main_table.appendChild(row);

                //Main table structure is now complete. Add all the relevant details in TDs
                let td_name = document.createElement('td');
                row.appendChild(td_name);
                td_name.innerHTML = cart_items[i].name;
                let cell_chair_price = cart_items[i].price;
                let td_price = document.createElement('td');
                row.appendChild(td_price);
                td_price.innerHTML = "Total: $" + cell_chair_price;
            }
        }

        displayCart();
    </script>

    <div id="cart_summary">   </div>

    <script>
        // Sum total price of all chairs in your cart
        function displayCartTotal() {
            let cartTotal = 0;

            for (let i = 0; i < cart_items.length; i++) {
                cartTotal += cart_items[i].price;
            }

            // Print totals
            let summary_table = document.createElement("table");
            let summary_row = document.createElement("tr");
            summary_table.appendChild(summary_row);

            summary_row.appendChild(document.createElement(("td")));

            let total_field = document.createElement("td");
            summary_row.appendChild(total_field);
            total_field.innerHTML = "$" + cartTotal.toString();

            document.getElementById("cart_summary").appendChild(summary_table);
        }
        displayCartTotal();
    </script>
    <input id="checkout" type="button" value="Checkout">

    <script>
        //Handler for moving to checkout page
        document.getElementById("checkout").onclick = function() {
            window.open('usercheckout.html'); // Replace this with location to the checkout
        };
    </script> 
</body>
</html>