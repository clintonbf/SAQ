<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>View our catalogue</title>

    <!-- init firebase mega thing-->
    <script src="https://www.gstatic.com/firebasejs/7.2.2/firebase-app.js"></script>
    <!-- init firestore -->
    <script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
    <!-- init SAQ firebase -->
    <script src="firebase_config.js"></script>
    <!-- init SAQ objects -->
    <script src="SAQ_objects.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
<div class = "container.container" style = "background-color: gray; padding: 10px">
    <div><h1 class= "OurSite"><img class="icon" src="images/home_page/iconchair.png" alt = "chair-icon">
        Sit Your Ass Down </h1></div>
    <form><div class="containerR"><input value = "Search"><button type="submit"> Go </button>
    </div></form></div>

    <div id="clint" class="chairBox">
        <table>
            <tr>
                <td>
                    <table class="picture">
                        <tr><td><a href="chair_specific.html"><img id="clint_pic" height="100" width="100"></a></td></tr>
                    </table>
                </td>
                <td>
                    <table class= "chair_info">
                        <tr><td id="clint_name"></td></tr>
                        <tr><td id="clint_comfort_options"></td></tr>
                        <tr><td id="clint_price"></td><td id="clint_rating"></td></tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div id="fahad" class="chairBox">
        <table>
            <tr>
                <td>
                    <table class="picture">
                        <tr><td><img id="fahad_pic" height="100" width="100"></td></tr>
                    </table>
                </td>
                <td>
                    <table class= "chair_info">
                        <tr><td id="fahad_name"></td></tr>
                        <tr><td id="fahad_comfort_options"></td></tr>
                        <tr><td id="fahad_price"></td><td id="fahad_rating"></td></tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div id="em" class="chairBox">
        <table>
            <tr>
                <td>
                    <table class="picture">
                        <tr><td><img id="em_pic" height="100" width="100"></td></tr>
                    </table>
                </td>
                <td>
                    <table class= "chair_info">
                        <tr><td id="em_name"></td></tr>
                        <tr><td id="em_comfort_options"></td></tr>
                        <tr><td id="em_price"></td><td id="em_rating"></td></tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div id="neda" class="chairBox">
        <table>
            <tr>
                <td>
                    <table class="picture">
                        <tr><td><img id="neda_pic" height="100" width="100"></td></tr>
                    </table>
                </td>
                <td>

                    <table class= "chair_info">
                        <tr><td id="neda_name"></td></tr>
                        <tr><td id="neda_comfort_options"></td></tr>
                        <tr><td id="neda_price"></td><td id="neda_rating"></td></tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div id="sam" class="chairBox">
        <table>
            <tr>
                <td>
                    <table class="picture">
                        <tr><td><img id="sam_pic" height="100" width="100"></td></tr>
                    </table>
                </td>
                <td>
                    <table class= "chair_info">
                        <tr><td id="sam_name"></td></tr>
                        <tr><td id="sam_comfort_options"></td></tr>
                        <tr><td id="sam_price"></td><td id="sam_rating"></td></tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div id="chris" class="chairBox">
        <table>
            <tr>
                <td>
                    <table class="picture">
                        <tr><td><img id="chris_pic" height="100" width="100"></td></tr>
                    </table>
                </td>
                <td>
                    <table class= "chair_info">
                        <tr><td id="chris_name"></td></tr>
                        <tr><td id="chris_comfort_options"></td></tr>
                        <tr><td id="chris_price"></td><td id="chris_rating"></td></tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <script>var the_db = firebase.firestore();</script>
    <script>
        // Get a prefix based on the chair name
        function get_prefix(chair_name) {
            if (chair_name === 'the Clint') {
                return 'clint_';
            }
            else if (chair_name === 'the Fahad') {
                return 'fahad_';
            }
            else if (chair_name === 'the Em') {
                return 'em_';
            }
            else if (chair_name === 'the Neda') {
                return 'neda_';
            }
            else if (chair_name === 'the Sam') {
                return 'sam_';
            }
            else if (chair_name === 'the Chris') {
                return 'chris_';
            }
        }

        // Calculate an average
        function calculate_average(arr) {
            let sum = 0;

            for (let i = 0; i < arr.length; i++) {
                sum += arr[i];
            }

            return Math.floor(sum/arr.length);
        }

        // Get a chair from the DB
        function get_single_chair(chair_id) {
            let db_ref = the_db.collection("Chairs").doc(chair_id);

            db_ref.get().then(function(doc){
                if (doc.exists){
                    let ratings =  doc.data().ratings;
                    let options = [doc.data().firmness,  doc.data().back_support, doc.data().arms];
                    //id, name, price, comfort_options, ratings, picture
                    let chair = new Chair(doc.data().id, doc.data().name, doc.data().price, options, ratings, doc.data().picture);

                    document.getElementById('chair_name').innerHTML = chair.name;
                    document.getElementById('price').innerHTML = "$" + chair.price;
                    document.getElementById('rating').innerHTML = chair.ratings;
                    document.getElementById('pic').src = chair.picture;
                }
                else {
                    console.log("Didn't work");
                }
            }).catch(function(error) {
                console.log("Threw error " + error);
            });
        }

        function display_catalog() {
            let db_ref = the_db.collection("clints_work"); // ToDo <----- replace with live Collection

            db_ref.get().then(function(catalog) {
               // Create a div area and put the chair into it
               catalog.forEach(function(doc){
                   let name = doc.data().name;
                   let prefix = get_prefix(name);

                   document.getElementById(prefix + "name").innerHTML = name;
                   document.getElementById(prefix + "price").innerHTML = '$' + doc.data().price;
                   document.getElementById(prefix + "rating").innerHTML = "Average rating: " + calculate_average(doc.data().ratings);
                   document.getElementById(prefix + "pic").src = doc.data().picture;
               })
            }).catch(function(error) {
                console.log("Error displaying all items");
            });
        }

        // get_single_chair("chair_0");
        display_catalog();

        function filter_by_price() {
            // Use JS to loop through the chairs_array
            // and set the CSS display:none property according to the filter-criteria and the element_id

            let min_price = document.getElementById('min_price');
            let max_price = document.getElementById('max_price');

            //Set a CSS display property to hidden or visible


        }
    </script>


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</body>
</html>